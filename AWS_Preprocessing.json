{"paragraphs":[{"text":"%md\n\n## Imports","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Imports</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451917_-1618324025","id":"20181220-094529_741989106","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:330"},{"text":"// Imports\nimport sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection \nimport org.apache.spark.sql.functions._\nimport sqlContext.implicits._\nimport org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\nimport org.apache.spark.sql.SQLContext\nimport com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\nimport org.apache.spark.sql.cassandra._\nimport com.datastax.spark.connector._\nimport org.apache.spark.sql.types.IntegerType\n","user":"anonymous","dateUpdated":"2019-01-23T16:00:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection\nimport org.apache.spark.sql.functions._\nimport sqlContext.implicits._\nimport org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\nimport org.apache.spark.sql.SQLContext\nimport com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\nimport org.apache.spark.sql.cassandra._\nimport com.datastax.spark.connector._\nimport org.apache.spark.sql.types.IntegerType\n"}]},"apps":[],"jobName":"paragraph_1548256451922_-1450618114","id":"20181220-093420_248996215","dateCreated":"2019-01-23T15:14:11+0000","dateStarted":"2019-01-23T16:00:20+0000","dateFinished":"2019-01-23T16:00:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:331"},{"text":"%md\nCreate the Cassandra Keyspace","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Create the Cassandra Keyspace</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451923_-1874349115","id":"20190123-130830_446290071","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:332"},{"text":"%cassandra\nCREATE KEYSPACE gdelt_datas WITH replication = {'class': 'SimpleStrategy', 'replication_factor' : 3};\nUSE gdelt_datas;","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451924_-1090367162","id":"20190123-130825_1107114488","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:333"},{"text":"%md\n ## Download datas","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Download datas</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451924_270166520","id":"20181220-094645_1016288376","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:334"},{"text":"%md\nWe can define a file downloader function to load the datas later on","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>We can define a file downloader function to load the datas later on</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451925_1791524502","id":"20190117-205013_1847733823","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:335"},{"text":"def fileDownloader(urlOfFileToDownload: String, fileName: String) = {\n    val url = new URL(urlOfFileToDownload)\n    val connection = url.openConnection().asInstanceOf[HttpURLConnection]\n    connection.setConnectTimeout(5000)\n    connection.setReadTimeout(5000)\n    connection.connect()\n\n    if (connection.getResponseCode >= 400)\n        println(\"error\")\n    else\n        url #> new File(fileName) !!\n}","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one feature warning; re-run with -feature for details\nfileDownloader: (urlOfFileToDownload: String, fileName: String)Any\n"}]},"apps":[],"jobName":"paragraph_1548256451926_1781328104","id":"20181220-093435_1203523695","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:336"},{"text":"fileDownloader(\"http://data.gdeltproject.org/gdeltv2/masterfilelist.txt\", \"/tmp/masterfilelist.txt\") // save the list file to the Spark Master\nfileDownloader(\"http://data.gdeltproject.org/gdeltv2/masterfilelist-translation.txt\", \"/tmp/masterfilelist_translation.txt\") //same for Translation file\nawsClient.putObject(\"fabien-mael-telecom-gdelt2018\", \"masterfilelist.txt\", new File(\"/tmp/masterfilelist.txt\") )\nawsClient.putObject(\"fabien-mael-telecom-gdelt2018\", \"masterfilelist_translation.txt\", new File( \"/tmp/masterfilelist_translation.txt\") )","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res6: Any = \"\"\n"}]},"apps":[],"jobName":"paragraph_1548256451926_-763405471","id":"20181220-093606_2031630974","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:337"},{"text":"%md\n## Load the (english) data and concatenate them in a DataFrame","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Load the (english) data and concatenate them in a DataFrame</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451927_-779853533","id":"20181220-095031_1161999018","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:338"},{"text":"%md\nGrab the list of the URLs to download.","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Grab the list of the URLs to download.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451927_-2143398024","id":"20190117-205141_1381989381","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:339"},{"text":"%md\nDue to a recent change in architecture, we will work with only 1 month of data. (1 year would take too much time)","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Due to a recent change in architecture, we will work with only 1 month of data. (1 year would take too much time)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451928_-1868076020","id":"20190117-205320_1892569544","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:340"},{"text":"// English Data\nval list_csv = spark.read.format(\"csv\").option(\"delimiter\", \" \").\n                    csv(\"s3a://fabien-mael-telecom-gdelt2018/masterfilelist.txt\").\n                    withColumnRenamed(\"_c0\",\"size\").\n                    withColumnRenamed(\"_c1\",\"hash\").\n                    withColumnRenamed(\"_c2\",\"url\")\nval list_2018_tot = list_csv.where(col(\"url\").like(\"%/2018%\"))\nlist_2018_tot.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = \"/mnt/tmp/\"\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n            val localFile = new File(localFileName)\n            AwsClient.s3.putObject(\"fabien-mael-telecom-gdelt2018\", fileName, localFile )\n            localFile.delete()\n})","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"list_2018_tot: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1548256451929_1840765554","id":"20190121-172455_1752086806","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:341"},{"text":"// Translation data\nval list_csv_translation = spark.read.format(\"csv\").option(\"delimiter\", \" \").\n                    csv(\"s3a://fabien-mael-telecom-gdelt2018/masterfilelist_translation.txt\").\n                    withColumnRenamed(\"_c0\",\"size\").\n                    withColumnRenamed(\"_c1\",\"hash\").\n                    withColumnRenamed(\"_c2\",\"url\")\nval list_2018_translation_tot = list_csv_translation.where(col(\"url\").like(\"%/2018%\"))\nlist_2018_translation_tot.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = \"/mnt/tmp/\"\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n            val localFile = new File(localFileName)\n            AwsClient.s3.putObject(\"fabien-mael-telecom-gdelt2018\", fileName, localFile )\n            localFile.delete()\n            \n})","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451929_-1016698907","id":"20190123-130436_214627506","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:342"},{"text":"%md\nWe concatenate the downloaded files, unzip them, and select only the interesting values.","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>We concatenate the downloaded files, unzip them, and select only the interesting values.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451929_1984582348","id":"20190117-205751_1900321598","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:343"},{"text":"%md\n## Create the data frames","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Create the data frames</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451930_1891072151","id":"20190122-201623_1615705457","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:344"},{"text":"// Mentions Translation\nval mentionsRDD_trans = sc.binaryFiles(\"s3a://fabien-mael-telecom-gdelt2018/201801*translation.mentions.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile{ case null => zis.close(); false\n                       case _ => true }.\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\nval mentionsDF_trans = mentionsRDD_trans.map(x => x.split(\"\\t\")).map(row => row.mkString(\";\")).map(x => x.split(\";\")).toDF()\n\n// Export Translation\nval exportRDD_trans = sc.binaryFiles(\"s3a://fabien-mael-telecom-gdelt2018/201801*translation.export.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile{ case null => zis.close(); false\n                       case _ => true }.\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\nval exportDF_trans = exportRDD_trans.map(x => x.split(\"\\t\")).map(row => row.mkString(\";\")).map(x => x.split(\";\")).toDF()\n\n// Export English\nval exportRDD = sc.binaryFiles(\"s3a://fabien-mael-telecom-gdelt2018/201801*.export.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile{ case null => zis.close(); false\n                       case _ => true }.\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\nval exportDF = exportRDD.map(x => x.split(\"\\t\")).map(row => row.mkString(\";\")).map(x => x.split(\";\")).toDF()\n\n// Mentions English\nval mentionsRDD = sc.binaryFiles(\"s3a://fabien-mael-telecom-gdelt2018/201801*.mentions.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile{ case null => zis.close(); false\n                       case _ => true }.\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\nval mentionsDF = mentionsRDD.map(x => x.split(\"\\t\")).map(row => row.mkString(\";\")).map(x => x.split(\";\")).toDF()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mentionsRDD_trans: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[10] at flatMap at <console>:50\nmentionsDF_trans: org.apache.spark.sql.DataFrame = [value: array<string>]\n"}]},"apps":[],"jobName":"paragraph_1548256451930_1828394995","id":"20190122-201349_36935317","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:345"},{"text":"%md\n## Question 1","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Question 1</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451931_2103034439","id":"20190122-201351_1049963620","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:346"},{"text":"%md\nNumber of articles or events per day, country and language","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Number of articles or events per day, country and language</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451931_846616974","id":"20190122-204107_1987166303","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:347"},{"text":"// Mentions\nval mentions_trans_1 = mentionsDF_trans.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(0).as(\"globaleventid\"),\n    $\"_tmp\".getItem(14).as(\"language\")\n    )\nval mentions_1 = mentionsDF.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(0).as(\"globaleventid\"),\n    $\"_tmp\".getItem(14).as(\"language\")\n    )\n    \n// Events \nval events_trans_1 = exportDF_trans.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(0).as(\"globaleventid\"),\n    $\"_tmp\".getItem(1).as(\"day\"),\n    $\"_tmp\".getItem(33).as(\"numarticles\"),\n    $\"_tmp\".getItem(53).as(\"actioncountry\")\n    )\nval events_1 = exportDF.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(0).as(\"globaleventid\"),\n    $\"_tmp\".getItem(1).as(\"day\"),\n    $\"_tmp\".getItem(33).as(\"numarticles\"),\n    $\"_tmp\".getItem(53).as(\"actioncountry\")\n    )\n    \nval df_events_1 = events_1.union(events_trans_1)\nval df_mentions_1 = mentions_1.union(mentions_trans_1)","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mentions_trans_1: org.apache.spark.sql.DataFrame = [GlobalEventID: string, Language: string]\nmentions_1: org.apache.spark.sql.DataFrame = [GlobalEventID: string, Language: string]\n"}]},"apps":[],"jobName":"paragraph_1548256451932_569928455","id":"20190122-202152_891095573","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:348"},{"text":"// Join events and mentions\nval df_1 = df_mentions_1.join(df_events_1,\"GlobalEventID\")\n\n// Fill in Nan by English language\nval df_1_final =  df_1.withColumn(\"language\",\n    when(col(\"language\").isNull, \"eng\").\n    otherwise(substring_index(col(\"language\"), \":\", -1))\n    )\n\n// Cast Type\nval df_1_cast = df_1_final.withColumn(\"day\", df_1_final(\"day\").cast(IntegerType)).withColumn(\"numarticles\", df_1_final(\"numarticles\").cast(IntegerType))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_1: org.apache.spark.sql.DataFrame = [GlobalEventID: string, Language: string ... 3 more fields]\ndf_1_final: org.apache.spark.sql.DataFrame = [GlobalEventID: string, Language: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1548256451932_-710573981","id":"20190122-202338_1944600352","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:349"},{"text":"// Create several data frames to load in Cassandra\nval df_1_gby = df_1_cast.groupBy(\"day\", \"language\", \"actioncountry\").agg(sum($\"numarticles\").as(\"numarticles\"))\nval df_1_day_gby = df_1_cast.groupBy(\"day\").agg(sum($\"numarticles\").as(\"numarticles\"))\nval df_1_lang_gby = df_1_cast.groupBy(\"language\").agg(sum($\"numarticles\").as(\"numarticles\"))\nval df_1_act_gby = df_1_cast.groupBy(\"actioncountry\").agg(sum($\"numarticles\").as(\"numarticles\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_1_gby: org.apache.spark.sql.DataFrame = [day: int, language: string ... 2 more fields]\ndf_1_day_gby: org.apache.spark.sql.DataFrame = [day: int, numarticles: bigint]\ndf_1_lang_gby: org.apache.spark.sql.DataFrame = [language: string, numarticles: bigint]\ndf_1_act_gby: org.apache.spark.sql.DataFrame = [actioncountry: string, numarticles: bigint]\n"}]},"apps":[],"jobName":"paragraph_1548256451933_-116206521","id":"20190122-203102_946382129","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:350"},{"text":"%md\nIn Cassandra","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In Cassandra</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451934_1184469794","id":"20190123-103840_163986914","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:351"},{"text":"%cassandra\nCREATE TABLE q1_1(\nday int,\nlanguage text,\nactioncountry text,\nnumarticles int,\nPRIMARY KEY (day, language, actioncountry));\n\nCREATE TABLE q1_2(\nday int,\nnumarticles int,\nPRIMARY KEY (day));\n\nCREATE TABLE q1_3(\nlanguage text,\nnumarticles int,\nPRIMARY KEY (language));\n\nCREATE TABLE q1_4(\nactioncountry text,\nnumarticles int,\nPRIMARY KEY (actioncountry));","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451934_1084878300","id":"20190123-104504_1975729990","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:352"},{"text":"df_1_gby.write.cassandraFormat(\"q1_1\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451934_873151674","id":"20190123-103840_76302776","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:353"},{"text":"df_1_day_gby.write.cassandraFormat(\"q1_2\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451935_655614030","id":"20190123-103944_608905967","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:354"},{"text":"df_1_lang_gby.write.cassandraFormat(\"q1_3\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451935_-618115187","id":"20190123-103950_1504391799","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:355"},{"text":"df_1_act_gby.write.cassandraFormat(\"q1_4\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451936_174904401","id":"20190123-103951_775844323","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:356"},{"text":"%md\nRead it","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Read it</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451936_-1940259020","id":"20190123-103857_187703933","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:357"},{"text":"val df_1_1 = spark.read.cassandraFormat(\"q1_1\", \"gdelt_datas\").load()\nval df_1_2 = spark.read.cassandraFormat(\"q1_2\", \"gdelt_datas\").load()\nval df_1_3 = spark.read.cassandraFormat(\"q1_3\", \"gdelt_datas\").load()\n//val df_1_4 = spark.read.cassandraFormat(\"q1_4\", \"gdelt_datas\").load()\ndf_1_1.take(1)","user":"anonymous","dateUpdated":"2019-01-23T16:00:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_1_1: org.apache.spark.sql.DataFrame = [day: int, language: string ... 2 more fields]\ndf_1_2: org.apache.spark.sql.DataFrame = [day: int, numarticles: int]\ndf_1_3: org.apache.spark.sql.DataFrame = [language: string, numarticles: int]\nres12: Array[org.apache.spark.sql.Row] = Array([20171202,bul,BU,40])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-34.ec2.internal:4041/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548256451937_594769530","id":"20190123-105454_300505575","dateCreated":"2019-01-23T15:14:11+0000","dateStarted":"2019-01-23T16:00:56+0000","dateFinished":"2019-01-23T16:02:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:358"},{"text":"df_1_1.createOrReplaceTempView(\"q1_1\")\ndf_1_2.createOrReplaceTempView(\"q1_2\")\ndf_1_3.createOrReplaceTempView(\"q1_3\")\n//df_1_3.createOrReplaceTempView(\"q1_4\")","user":"anonymous","dateUpdated":"2019-01-23T16:02:54+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548256451937_-161419961","id":"20190122-202412_1132380473","dateCreated":"2019-01-23T15:14:11+0000","dateStarted":"2019-01-23T16:02:54+0000","dateFinished":"2019-01-23T16:02:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"%md\nNumber of articles by day, language and action country","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Number of articles by day, language and action country</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451938_230871310","id":"20190123-131510_944150659","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:360"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q1_1 ORDER BY NumArticles DESC LIMIT 10 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T16:03:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Day","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Language","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"ActionCountry","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NumArticles","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"day":"string","language":"string","actioncountry":"string","numarticles":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[],"values":[]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tlanguage\tactioncountry\tnumarticles\n20180131\teng\tUS\t4008450\n20180110\teng\tUS\t3736300\n20180112\teng\tUS\t3335687\n20180119\teng\tUS\t3228617\n20180123\teng\tUS\t3180725\n20180104\teng\tUS\t3161869\n20180118\teng\tUS\t3082181\n20180105\teng\tUS\t2947290\n20180111\teng\tUS\t2915576\n20180117\teng\tUS\t2848619\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-34.ec2.internal:4041/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548256451938_-675361683","id":"20190122-203100_1679093043","dateCreated":"2019-01-23T15:14:11+0000","dateStarted":"2019-01-23T16:02:57+0000","dateFinished":"2019-01-23T16:03:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:361"},{"text":"df_1_1.count()","user":"anonymous","dateUpdated":"2019-01-23T16:03:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res21: Long = 97399\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-34.ec2.internal:4041/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548257170877_-1199151409","id":"20190123-152610_1903988543","dateCreated":"2019-01-23T15:26:10+0000","dateStarted":"2019-01-23T16:03:21+0000","dateFinished":"2019-01-23T16:03:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:362"},{"text":"%md\nNumber of articles by day","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Number of articles by day</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451939_-122124668","id":"20190123-131530_519896268","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:363"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q1_2  \"\"\"))","user":"anonymous","dateUpdated":"2019-01-24T09:02:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Day":"string","NumArticles":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"numarticles","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tnumarticles\n20170128\t89771\n20180110\t17697313\n20170107\t34899\n20170129\t87848\n20170113\t32856\n20180128\t9999044\n20080107\t454\n20171215\t17698\n20180107\t8080518\n20171206\t15310\n20080112\t260\n20180116\t18388530\n20170116\t102482\n20171227\t33421\n20180108\t14064160\n20080120\t314\n20180105\t14305087\n20170102\t66887\n20170125\t75581\n20170130\t142430\n20170121\t65526\n20170115\t72416\n20171210\t107447\n20170111\t96058\n20170109\t90856\n20180112\t15704421\n20180119\t17638433\n20080202\t237\n20180126\t15704859\n20080130\t196\n20180109\t14523273\n20080113\t205\n20180115\t15185497\n20171207\t17257\n20080109\t90\n20170105\t65913\n20180111\t17331766\n20180113\t10268180\n20171225\t84508\n20180103\t14114527\n20171213\t35965\n20171224\t20408\n20170104\t59891\n20171211\t107645\n20080114\t4968\n20180122\t16652289\n20170124\t82804\n20180123\t17622005\n20170108\t93493\n20171220\t43982\n20171230\t50150\n20171208\t34505\n20170103\t65751\n20170126\t88609\n20171229\t72011\n20080125\t517\n20080129\t294\n20180127\t10987292\n20080115\t429\n20180104\t14395222\n20170106\t51574\n20080122\t135\n20170117\t71022\n20080124\t244\n20180102\t10636701\n20171216\t33596\n20170101\t42662\n20170131\t68827\n20080116\t102\n20180124\t15909490\n20080131\t86\n20180125\t15871011\n20080126\t232\n20080110\t124\n20170122\t106327\n20170114\t58878\n20170110\t111416\n20180130\t15579525\n20171203\t18036\n20180129\t12538693\n20180118\t15989104\n20080117\t397\n20180114\t9248911\n20171228\t100286\n20171219\t22672\n20171204\t55406\n20171202\t11631\n20180106\t9879301\n20170123\t140774\n20080127\t708\n20170120\t122164\n20171223\t18739\n20180101\t8022230\n20080121\t297\n20080128\t2308\n20080104\t215\n20080123\t62\n20080106\t246\n20170112\t73780\n20080119\t196\n20180117\t17392350\n20171226\t67594\n20171217\t138561\n20171222\t13531\n20171209\t28310\n20080118\t215\n20180131\t17171532\n20171221\t80960\n20170127\t106562\n20080105\t376\n20180120\t14119871\n20080108\t393\n20080203\t198\n20171212\t33321\n20171231\t77195\n20170119\t65664\n20171214\t8354\n20171205\t56109\n20180121\t14362446\n20080111\t233\n20080201\t1310\n20170118\t56997\n20171218\t26472\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-34.ec2.internal:4041/jobs/job?id=3","http://ip-172-31-8-34.ec2.internal:4041/jobs/job?id=4","http://ip-172-31-8-34.ec2.internal:4041/jobs/job?id=5","http://ip-172-31-8-34.ec2.internal:4041/jobs/job?id=6"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548256451939_562636454","id":"20190123-081602_81474640","dateCreated":"2019-01-23T15:14:11+0000","dateStarted":"2019-01-23T16:03:32+0000","dateFinished":"2019-01-23T16:03:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:364"},{"text":"%md \nNumber of articles by Language","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Number of articles by Language</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451940_-2031823147","id":"20190123-131542_233951063","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:365"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q1_3 ORDER BY NumArticles DESC LIMIT 20  \"\"\"))","user":"anonymous","dateUpdated":"2019-01-24T09:02:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Language":"string","NumArticles":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"language","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"numarticles","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"language\tnumarticles\neng\t177249392\nspa\t72558312\nara\t36259474\nfra\t21745230\ndeu\t11938026\nsqi\t9832686\nron\t9475158\npor\t9199508\nell\t8647012\nmkd\t5203514\nbul\t4076058\nswe\t4003498\nind\t3812700\npol\t3055514\ndan\t2676076\nukr\t2484686\nces\t2263820\nhun\t2008472\nkor\t1968704\nsrp\t1647142\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-8-34.ec2.internal:4041/jobs/job?id=7"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548256451940_-446789348","id":"20190123-083010_1335241968","dateCreated":"2019-01-23T15:14:11+0000","dateStarted":"2019-01-23T16:04:25+0000","dateFinished":"2019-01-23T16:04:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:366"},{"text":"%md\nNumber of articles by Action Country","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Number of articles by Action Country</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451941_-1036121752","id":"20190123-131602_231144857","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:367"},{"text":"//z.show(spark.sql(\"\"\" SELECT * FROM q1_4 ORDER BY NumArticles DESC LIMIT 20  \"\"\"))","user":"anonymous","dateUpdated":"2019-01-24T09:02:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ActionCountry":"string","NumArticles":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"ActionCountry","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"NumArticles","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ActionCountry\tNumArticles\nUS\t9.0253606E7\n\t3.6429454E7\nIS\t1.7444393E7\nUK\t1.5866762E7\nRS\t1.4170763E7\nVE\t1.3824685E7\nTU\t1.1456866E7\nFR\t9546268.0\nIR\t9236514.0\nGM\t8818003.0\nSP\t7381487.0\nUP\t7098828.0\nSY\t7003781.0\nMX\t6647563.0\nCH\t6484249.0\nCI\t5969766.0\nMK\t5646567.0\nRO\t5495141.0\nIT\t5471838.0\nEG\t5422691.0\n"}]},"apps":[],"jobName":"paragraph_1548256451941_1738659599","id":"20190123-083012_2086751799","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:368"},{"text":"%md\n## Question 2","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Question 2</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451942_-1001872746","id":"20190122-203012_1773081861","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:369"},{"text":"%md\nFor a given actor, show all events making reference to it","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>For a given actor, show all events making reference to it</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451942_2024491670","id":"20190122-204103_223025082","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:370"},{"text":"val events_trans_2 = exportDF_trans.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(5).as(\"actor1code\"),\n    $\"_tmp\".getItem(37).as(\"actor1country\"),\n    $\"_tmp\".getItem(56).as(\"actionlat\"),\n    $\"_tmp\".getItem(57).as(\"actionlong\")\n    )\n    \nval events_2 = exportDF.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(5).as(\"actor1code\"),\n    $\"_tmp\".getItem(37).as(\"actor1country\"),\n    $\"_tmp\".getItem(56).as(\"actionlat\"),\n    $\"_tmp\".getItem(57).as(\"actionlong\")\n    )\n    \nval df_events_2 = events_2.union(events_trans_2)\nval df_2_cast =  df_events_2.withColumn(\"actionlat\", df_events_2(\"actionlat\").cast(\"float\")).withColumn(\"actionlong\", df_events_2(\"actionlong\").cast(\"float\"))\n","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"events_trans_2: org.apache.spark.sql.DataFrame = [Actor1Code: string, Actor1Country: string ... 2 more fields]\nevents_2: org.apache.spark.sql.DataFrame = [Actor1Code: string, Actor1Country: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1548256451943_-168905102","id":"20190122-204756_1720901837","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:371"},{"text":"%md\nIn Cassandra","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In Cassandra</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451943_1543156572","id":"20190123-110755_185987140","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:372"},{"text":"%cassandra\nCREATE TABLE q2(\nactor1code text,\nactor1country text,\nactionlat double,\nactionlong double,\nPRIMARY KEY (actor1code, actor1country));","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[]},"apps":[],"jobName":"paragraph_1548256451944_1496659295","id":"20190123-110650_513226082","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:373"},{"text":"df_2_cast.write.cassandraFormat(\"q2\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451944_1695165586","id":"20190123-110753_1720579680","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:374"},{"text":"val df_2 = spark.read.cassandraFormat(\"q2\", \"gdelt_datas\").load()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451945_190823452","id":"20190123-110804_384879559","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:375"},{"text":"df_2.createOrReplaceTempView(\"q2\")","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548256451945_-1822644306","id":"20190122-204753_906850842","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:376"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q2 LIMIT 150 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"zeppelin-leaflet","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Actor1Code":"string","Actor1Country":"string","ActionLat":"string","ActionLong":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"zeppelin-leaflet":{"latitude":{"name":"ActionLat","index":2,"aggr":"sum"},"longitude":{"name":"ActionLong","index":3,"aggr":"sum"},"popup":{"name":"Actor1Code","index":0,"aggr":"sum"},"tooltip":{"name":"Actor1Country","index":1,"aggr":"sum"}}}},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Actor1Code\tActor1Country\tActionLat\tActionLong\nAGR\tUS\t45.7326\t-93.9196\nAGR\tMX\t23\t-102\nAGR\tMX\t23\t-102\nAGR\tUS\t45.7326\t-93.9196\nAGR\tMX\t23\t-102\nUSA\tUS\t38.8951\t-77.0364\n\t\t23\t-102\nCOP\tAS\t-37.7833\t144.933\nCOP\tAS\t-37.8167\t144.967\nCOP\tAS\t-37.8167\t144.967\n"}]},"apps":[],"jobName":"paragraph_1548256451946_1630857243","id":"20190122-205539_111043584","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:377"},{"text":"%md\n## Question 3","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Question 3</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451946_-2036227492","id":"20190122-205658_992617314","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:378"},{"text":"%md\nThe subjects (actors) which recieved the most positive/negative articles (month, country, language)","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The subjects (actors) which recieved the most positive/negative articles (month, country, language)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451947_-1993997062","id":"20190122-205537_1795601511","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:379"},{"text":"// Mentions\nval mentions_trans_3 = mentionsDF_trans.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(0).as(\"globaleventid\"),\n    $\"_tmp\".getItem(14).as(\"language\")\n    )\nval mentions_3 = mentionsDF.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(0).as(\"globaleventid\"),\n    $\"_tmp\".getItem(14).as(\"language\")\n    )\n\n// Events\nval events_trans_3 = exportDF_trans.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(0).as(\"globaleventid\"),\n    $\"_tmp\".getItem(2).as(\"month\"),\n    $\"_tmp\".getItem(5).as(\"actor1code\"),\n    $\"_tmp\".getItem(34).as(\"avgtone\"),\n    $\"_tmp\".getItem(37).as(\"actor1country\"),\n    $\"_tmp\".getItem(53).as(\"actioncountry\")\n    )\nval events_3 = exportDF.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(0).as(\"globaleventid\"),\n    $\"_tmp\".getItem(2).as(\"month\"),\n    $\"_tmp\".getItem(5).as(\"actor1code\"),\n    $\"_tmp\".getItem(34).as(\"avgtone\"),\n    $\"_tmp\".getItem(37).as(\"actor1country\"),\n    $\"_tmp\".getItem(53).as(\"actioncountry\")\n    )\n\n// Merge\nval df_events_3 = events_3.union(events_trans_3)\nval df_mentions_3 = mentions_3.union(mentions_trans_3)\n\n// Join\nval df_3 = df_mentions_3.join(df_events_3,\"globaleventid\")\n\n// Replace Language\nval df_3_final =  df_3.withColumn(\"language\",\n    when(col(\"language\").isNull, \"eng\").\n    otherwise(substring_index(col(\"language\"), \":\", -1))\n    )\n    \n// And cast\nval df_3_cast =  df_3_final.withColumn(\"avgtone\", df_3_final(\"avgtone\").cast(\"float\")).withColumn(\"month\", df_3_final(\"month\").cast(IntegerType))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mentions_trans_3: org.apache.spark.sql.DataFrame = [GlobalEventID: string, Language: string]\nmentions_3: org.apache.spark.sql.DataFrame = [GlobalEventID: string, Language: string]\n"}]},"apps":[],"jobName":"paragraph_1548256451947_2027003567","id":"20190122-205535_1353610834","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:380"},{"text":"// Group By : Split for the different tables\nval df_3_gby = df_3_cast.groupBy( \"language\", \"actioncountry\", \"month\", \"actor1country\", \"actor1code\").agg(sum($\"avgtone\").as(\"sumtone\"))\nval df_3_action = df_3_cast.groupBy( \"actioncountry\").agg(sum($\"avgtone\").as(\"sumtone\"))\nval df_3_month = df_3_cast.groupBy(\"month\").agg(sum($\"avgtone\").as(\"sumtone\"))\nval df_3_actor = df_3_cast.groupBy(\"actor1code\").agg(sum($\"avgtone\").as(\"sumtone\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_3_gby: org.apache.spark.sql.DataFrame = [language: string, actioncountry: string ... 4 more fields]\ndf_3_action: org.apache.spark.sql.DataFrame = [actioncountry: string, sumtone: double]\ndf_3_month: org.apache.spark.sql.DataFrame = [month: int, sumtone: double]\ndf_3_actor: org.apache.spark.sql.DataFrame = [actor1code: string, sumtone: double]\n"}]},"apps":[],"jobName":"paragraph_1548256451948_696349937","id":"20190122-213316_713192301","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:381"},{"text":"%md\nIn Cassandra","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In Cassandra</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451949_1209437478","id":"20190123-110910_1642098015","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:382"},{"text":"%cassandra\nCREATE TABLE q3_1(\nlanguage text,\nactioncountry text,\nmonth int,\nactor1country text,\nactor1code text,\nsumtone double,\nPRIMARY KEY (language, actioncountry, month));\n\nCREATE TABLE q3_2(\nactioncountry text,\nsumtone double,\nPRIMARY KEY (actioncountry));\n\nCREATE TABLE q3_3(\nmonth int,\nsumtone double,\nPRIMARY KEY (month));\n\nCREATE TABLE q3_4(\nactor1country text,\nactor1code text,\nsumtone double,\nPRIMARY KEY (actor1country, actor1code));","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451949_-546535021","id":"20190123-110909_1073456413","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:383"},{"text":"df_3_gby.write.cassandraFormat(\"q3_1\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451950_1984776577","id":"20190123-110930_1552482459","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:384"},{"text":"df_3_action.write.cassandraFormat(\"q3_2\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451950_1335083325","id":"20190123-111809_1127934706","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:385"},{"text":"df_3_month.write.cassandraFormat(\"q3_3\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451951_-964561130","id":"20190123-111805_1656905752","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:386"},{"text":"df_3_actor.write.cassandraFormat(\"q3_4\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451951_1780757896","id":"20190123-111829_1320112837","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:387"},{"text":"%md\nRead it","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Read it</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451952_1406178109","id":"20190123-110929_249304658","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:388"},{"text":"val df_3_1 = spark.read.cassandraFormat(\"q3_1\", \"gdelt_datas\").load()\nval df_3_2 = spark.read.cassandraFormat(\"q3_2\", \"gdelt_datas\").load()\nval df_3_3 = spark.read.cassandraFormat(\"q3_3\", \"gdelt_datas\").load()\nval df_3_4 = spark.read.cassandraFormat(\"q3_4\", \"gdelt_datas\").load()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451952_628793131","id":"20190123-110927_916851146","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:389"},{"text":"df_3_1.createOrReplaceTempView(\"q3_1\")\ndf_3_2.createOrReplaceTempView(\"q3_2\")\ndf_3_3.createOrReplaceTempView(\"q3_3\")\ndf_3_4.createOrReplaceTempView(\"q3_4\")","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548256451953_-355469333","id":"20190122-213353_1430788382","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:390"},{"text":"%md\nWhole table","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Whole table</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451953_-1937358546","id":"20190123-093039_1296555306","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:391"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q3 ORDER BY SumTone DESC LIMIT 100 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Language":"string","ActionCountry":"string","Month":"string","Actor1Country":"string","Actor1Code":"string","SumTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Language\tActionCountry\tMonth\tActor1Country\tActor1Code\tSumTone\nfra\tUV\t201801\tUV\tGOV\t128797.61436261055\nfra\tNI\t201801\tNI\tNGA\t120914.23124542223\nsqi\tMK\t201801\tMK\tMKD\t36464.508703556654\nfra\tNI\t201801\tNI\tNGAGOV\t35417.3920983893\nfra\tUV\t201801\tUV\tCVL\t35267.46338360101\nfra\tMZ\t201801\tCA\tGOV\t34314.91506233685\nfra\tUV\t201801\tNI\tNGA\t33865.826794771034\nfra\tUV\t201801\tNI\tGOV\t33865.82679477098\nfra\tUV\t201801\tUV\tNGA\t33854.338550712055\nfra\tCA\t201801\tCA\tNGAGOV\t33263.56177594181\nfra\tMZ\t201801\tMZ\tNGAGOV\t31450.365545276123\nara\tAE\t201801\tAE\tARE\t29507.799635669435\nfra\tCA\t201801\tCA\tGOV\t29323.293263335705\nara\tEG\t201801\tEG\tGOV\t28538.249314858214\nfra\tUV\t201801\tUV\tEDU\t28258.872279638825\nfra\tUV\t201801\tUV\tBFA\t26606.43998776134\nsqi\tMK\t201801\tMK\tGOV\t18551.261706031924\nsqi\tMK\t201801\t\t\t17701.715036208025\nslv\tUS\t201801\tUS\tEDU\t16466.773698269222\nara\tAE\t201801\tAE\tGOV\t16466.260853774023\nara\tNO\t201801\t\t\t16219.319804030822\nind\tID\t201801\tID\tGOV\t14442.490864889045\nara\tEG\t201801\tEG\tBUS\t14425.98370374684\nfra\tUV\t201801\t\t\t13563.224739893241\nara\tKU\t201801\tKU\tKWT\t12679.65833905682\nsqi\tGR\t201801\tMK\tMKD\t12551.70746270531\neng\t\t201801\t\tELI\t12283.62311987469\nsqi\tGR\t201801\tGR\tGRC\t11554.994158011246\nara\tAE\t201801\t\t\t11193.574740612343\nslv\tSI\t201801\tSI\tEDU\t10978.18904551242\nsqi\tGR\t201801\tGR\tMKD\t10869.602905111225\nara\tKU\t201801\tKU\tGOV\t10638.089489299464\nsqi\tMK\t201801\tGR\tGRC\t10407.018508389556\nfra\tCA\t201801\tCA\tCAN\t10268.062128730493\nsqi\tAL\t201801\tAL\tMKD\t10217.87010732995\nfra\tUV\t201801\tUV\tBUS\t9888.964322585922\nara\tBA\t201801\tBA\tGOV\t9730.619822508479\nfra\tUV\t201801\tFR\tBUS\t9291.372549019588\nara\tNO\t201801\tKV\tISR\t9290.454682324553\nara\tNO\t201801\tNO\tISR\t8753.315145007564\nsqi\tMK\t201801\tMK\tALB\t8697.06471356358\nara\tSA\t201801\tSA\tGOV\t8023.958933397252\nara\tAE\t201801\tAE\tBUS\t7229.749896707317\ntur\tTU\t201801\tTU\tEDU\t7047.8789975079735\nsqi\tAL\t201801\tMK\tMKD\t6911.005587504219\nmkd\tMK\t201801\tMK\tREL\t6641.097117263446\nsqi\tMK\t201801\tAL\tALB\t6472.572916835129\nara\tSA\t201801\tSA\tBUS\t6402.238341500554\nsqi\tMK\t201801\tMK\tIGOWSTNAT\t6387.203037438239\nsqi\tMK\t201801\tMK\tGRC\t6274.719336602749\nara\tIS\t201801\tIS\tBUS\t6248.313339588384\nsqi\tBU\t201801\tBU\tMKD\t6048.130973062592\nara\tBA\t201801\tBA\tBHR\t5864.909996508559\nslv\tUK\t201801\tUK\tMNCUSAMED\t5832.895725665819\nsqi\tMK\t201801\tMK\tREL\t5638.875495425159\nara\tSA\t201801\tSA\tEDU\t5500.9843021751585\nsqi\tGR\t201801\t\t\t5493.361417814323\nsqi\tBU\t201801\tMK\tMKD\t5490.46206988308\npor\tAO\t201801\tAO\tAGO\t5185.724605232667\nsqi\tGR\t201801\tMK\tGRC\t5096.388748693896\ntur\tTU\t201801\tTU\tBUS\t4827.664694033043\nsqi\tBU\t201801\tBU\tBGR\t4747.501303987575\nara\tBA\t201801\tBA\tBHRGOV\t4541.3381763099915\nsqi\tGR\t201801\tGR\tGOV\t4530.04845796288\nsqi\tMK\t201801\tBU\tBGR\t4497.494936818749\neng\tUS\t201801\tUS\tNMR\t4445.863749089574\nara\tIS\t201801\tIS\tltn\t4385.548237117399\nsrp\tRI\t201801\tRI\tGOV\t4290.379717648607\nlit\tLH\t201801\tLH\tMIL\t4276.401500362761\neng\tJA\t201801\tJA\tEDU\t4263.063130063344\nsqi\tBU\t201801\t\t\t4252.298894936781\nita\tIT\t201801\tIT\tBUS\t4244.844478405585\nsqi\tMK\t201801\tAL\tMKD\t4222.553251945165\nara\tTS\t201801\tTS\tEGY\t4169.8112598926555\nces\tEZ\t201801\tEZ\tCZELEG\t4086.853791045669\nara\tNL\t201801\tIS\tISR\t4074.3709459383167\ntur\t\t201801\t\tLABMED\t4038.1858438654626\neng\tUS\t201801\tUS\tMILMIL\t4025.0296506461405\nsqi\tGR\t201801\tGR\tGRCGOV\t4013.1190768254505\nara\tMU\t201801\t\t\t3988.0979243694164\nara\tBE\t201801\tGZ\tPSE\t3770.799051736157\nsqi\tBU\t201801\tBU\tBGRGOV\t3746.2869780136557\nara\tEG\t201801\tEG\tEGYBUS\t3675.0362159601436\nsqi\tMK\t201801\tGR\tMKD\t3666.6657049334804\nara\tBA\t201801\t\t\t3637.8224256808635\nara\tJO\t201801\tJO\tGOV\t3617.8178121772094\nara\tEG\t201801\tEG\tCHRCTH\t3586.5383156917037\nsqi\tMK\t201801\tMK\tBGR\t3540.4526017214966\ntur\tTU\t201801\tTU\tLEG\t3509.1632499017064\nmkd\tMK\t201801\tMK\tCHRDOX\t3480.0007333428507\nara\tCH\t201801\tCH\tCHNGOV\t3469.1546031350886\nara\tAE\t201801\tAE\tEDU\t3355.2391803444452\neng\tMU\t201801\tMU\tOMN\t3353.772630263157\nsqi\tBU\t201801\tBU\tGOV\t3304.5347048868616\nfra\tCH\t201801\tCH\tCHN\t3283.070026381684\nsqi\tMK\t201801\tBU\tGOV\t3185.363151978764\nara\tMU\t201801\tMU\tBUS\t3178.5844209508114\neng\tIN\t201801\tIN\tISR\t3166.918150436447\nara\tTS\t201801\tTS\tTUNLEG\t3134.8769941303303\nfra\tGM\t201801\tGM\tBFA\t3115.217129368129\n"}]},"apps":[],"jobName":"paragraph_1548256451954_1700275220","id":"20190122-214011_1786423000","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:392"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q3 ORDER BY SumTone ASC LIMIT 100 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Language":"string","ActionCountry":"string","Month":"string","Actor1Country":"string","Actor1Code":"string","SumTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Language\tActionCountry\tMonth\tActor1Country\tActor1Code\tSumTone\neng\tUS\t201801\tUS\tUSA\t-6349769.298010745\neng\tUS\t201801\t\t\t-1800572.0590303356\neng\tUS\t201801\tUS\tCOP\t-1365577.0567040334\neng\tUS\t201801\tUS\tJUD\t-1037184.958702697\neng\tUS\t201801\tUS\tGOV\t-1029943.3650900614\neng\t\t201801\t\tCOP\t-696337.9742912925\nara\tIS\t201801\tIS\tISR\t-694516.3164537457\neng\tIS\t201801\tIS\tISR\t-599651.2468628696\neng\tIR\t201801\tIR\tIRN\t-476389.1384875841\neng\tRS\t201801\tRS\tRUS\t-460193.67098307423\neng\tUS\t201801\tUS\tUSAGOV\t-447197.2760750123\nara\tIS\t201801\tIS\tPSE\t-423324.22929366713\neng\tUS\t201801\tUS\tLEG\t-411815.24689045193\neng\tUK\t201801\tUK\tGBR\t-406949.0395683968\neng\tPK\t201801\tPK\tPAK\t-346524.8272456341\neng\tTU\t201801\tTU\tTUR\t-338526.5100809098\neng\tAF\t201801\tAF\tAFG\t-302702.2691446696\neng\tUS\t201801\tUS\tUSAJUD\t-295071.9428891229\neng\t\t201801\t\t\t-280755.94288828695\neng\tCA\t201801\tCA\tCAN\t-271115.99691081396\neng\tUS\t201801\tUS\tMED\t-268788.711834635\nrus\tUP\t201801\tUP\tUKR\t-267664.65429953224\nspa\t\t201801\t\tCOP\t-265716.2179831591\nara\tIS\t201801\t\t\t-263753.33565581613\nspa\tUS\t201801\tUS\tUSA\t-262786.9455398653\neng\tSY\t201801\tSY\tSYR\t-261035.44741063105\neng\tUS\t201801\tUS\tCVL\t-258828.87864363872\neng\tUS\t201801\tUS\tUSAMED\t-253017.95232723976\neng\t\t201801\t\tJUD\t-247221.0434871146\neng\tUS\t201801\tUS\tUSACOP\t-246961.16146347806\nspa\t\t201801\t\tJUD\t-244965.57426636174\neng\tUS\t201801\tUS\tEDU\t-237455.5122975364\nspa\tVE\t201801\tVE\tVEN\t-235930.0530395925\neng\tNI\t201801\tNI\tNGA\t-217540.15066784597\nrus\tRS\t201801\tRS\tRUS\t-212418.38034767567\neng\tIS\t201801\tIS\tPSE\t-212223.9177633353\nara\tIR\t201801\tIR\tIRN\t-209639.03230470177\neng\tUS\t201801\tUS\tCRM\t-204603.628981258\nspa\t\t201801\t\t\t-184307.2023117817\nara\tIS\t201801\tIS\tCVL\t-180149.67929847626\nspa\t\t201801\t\tGOV\t-172277.78779171224\nara\tSY\t201801\tSY\tSYR\t-171789.1632014769\neng\tCI\t201801\tCI\tCHL\t-168865.5144841263\nara\tWE\t201801\tWE\tCVL\t-168319.04313539952\neng\tAS\t201801\tAS\tAUS\t-166962.4461666418\neng\tIN\t201801\tIN\tIND\t-163303.5187743192\nukr\tUP\t201801\tUP\tUKR\t-162937.13851093425\nron\tRO\t201801\tRO\tCOP\t-162321.14309058382\nspa\tVE\t201801\tVE\tGOV\t-159697.55395203174\neng\t\t201801\t\tGOV\t-159469.54999912027\neng\tUS\t201801\tUS\tHLH\t-157998.52424548726\nspa\tUS\t201801\t\t\t-157158.8620125344\neng\tFR\t201801\tFR\tFRA\t-153954.88847898398\nspa\tUS\t201801\tUS\tGOV\t-147651.96219124456\nara\tWE\t201801\tWE\tPSE\t-147297.5079153439\nsqi\tAL\t201801\tAL\tCOP\t-144915.67921992388\nara\tIS\t201801\tIS\tISRGOV\t-142024.9971967055\nfra\tFR\t201801\tFR\tFRA\t-141546.32481431562\nsqi\tAL\t201801\tAL\tALB\t-139613.56380775548\nron\tRO\t201801\tRO\tGOV\t-139482.83779427723\neng\tGM\t201801\tGM\tDEU\t-139368.10413714638\nara\tIS\t201801\tIS\tGOV\t-135261.68068308034\nspa\tSP\t201801\tSP\tESP\t-132642.0382868109\neng\tUK\t201801\t\t\t-130892.67581078286\nspa\tVE\t201801\t\t\t-128622.38702404963\neng\tUS\t201801\tUS\tBUS\t-123341.86030607668\neng\tIR\t201801\tIR\tGOV\t-123337.0697785568\nron\tRO\t201801\tRO\tROU\t-121120.4947004025\neng\tUS\t201801\tUS\tLAB\t-121082.40407757326\neng\tIN\t201801\tIN\tCOP\t-120239.4310085408\nspa\tCI\t201801\tCI\tCHL\t-118778.06211569774\nsqi\tAL\t201801\tAL\tGOV\t-118708.60360513352\neng\tRP\t201801\tRP\tPHL\t-116383.0487455989\neng\tUK\t201801\tUK\tCOP\t-114928.2695970728\ndeu\tGM\t201801\tGM\tDEU\t-114834.18141018799\neng\tKN\t201801\tKN\tPRK\t-114120.81392896721\nara\tUK\t201801\tUK\tCVL\t-113477.82906614878\ntur\tTU\t201801\tTU\tTUR\t-112831.05234869922\nrus\tUP\t201801\t\t\t-111768.89727050511\nara\tIS\t201801\tIS\tCOP\t-109348.55644156874\nsqi\tAL\t201801\t\t\t-108091.50910573629\neng\tIN\t201801\t\t\t-107074.9537443539\nrus\tRS\t201801\t\t\t-106101.9060381927\nspa\tMX\t201801\tMX\tMEX\t-103493.56668924543\neng\tIR\t201801\tIR\tIRNGOV\t-103475.23747533187\nrus\tUP\t201801\tUP\tCOP\t-103317.33912737692\nspa\tSP\t201801\t\t\t-101830.5259919331\neng\tIR\t201801\t\t\t-101150.92235873069\nspa\tMX\t201801\t\t\t-101066.99392000514\neng\tAF\t201801\tAF\tAFGINSTAL\t-100666.54282547807\neng\tUS\t201801\tUS\tMIL\t-100258.76239574015\nfra\tUS\t201801\tUS\tUSA\t-100035.36570381383\nsqi\tKV\t201801\tKV\tCOP\t-97541.05376463174\nspa\tSP\t201801\tSP\tJUD\t-97480.0135343466\nfra\tFR\t201801\t\t\t-96813.8850312096\nfra\tIR\t201801\tIR\tIRN\t-96105.63375375644\neng\tEG\t201801\tEG\tEGY\t-95638.40893215382\neng\tRS\t201801\tRS\tGOV\t-95167.4915078322\neng\t\t201801\t\tHLH\t-94762.17386428933\neng\tCH\t201801\tCH\tCHN\t-93021.4279876335\n"}]},"apps":[],"jobName":"paragraph_1548256451954_1490122719","id":"20190123-093028_1263527397","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:393"},{"text":"%md\nPer Action country","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Per Action country</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451955_1130546201","id":"20190123-093052_1362466408","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:394"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q3action ORDER BY SumTone DESC LIMIT 100 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ActionCountry":"string","SumTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"ActionCountry","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"SumTone","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ActionCountry\tSumTone\nUV\t340443.926881025\nMZ\t43770.593826950695\nKU\t15888.188126505413\nAE\t14125.251991165918\nMU\t5862.326363950745\nLS\t2582.318817776481\nCV\t2241.3007708163523\nLI\t1975.4617086841758\nBA\t1257.832948593884\nTK\t626.8789595992952\nSE\t603.5608258087244\nCW\t214.78630806062225\nAV\t204.24513098341657\nFG\t127.40987095042716\nAY\t98.53669365634288\nSC\t91.10897718585015\nTV\t61.89357273032202\nFM\t61.777255183127544\nCQ\t31.059837819954645\nTL\t19.972275217213717\nHQ\t17.831077730384294\nSH\t16.723622004771958\nIO\t9.828393135725431\nBV\t8.432378833207812\nFQ\t0.50761421319797\nDQ\t0.24906600249066\nJQ\t0.0\nWQ\t-11.89466544521295\nPF\t-21.72228010927029\nMN\t-27.977671415481467\nPG\t-42.78238349699044\nSB\t-47.506285941413594\nNF\t-48.308981647062325\nNE\t-53.06396752412246\nNH\t-91.83290992130254\nPC\t-99.8418548315737\nOC\t-100.93244972576093\nSV\t-112.46898831907596\nFK\t-120.47183916637744\nNT\t-130.29127923297006\nTP\t-152.18561763654168\nSM\t-259.7295860960562\nAQ\t-276.91985520822294\nBT\t-284.08977711493463\nVI\t-348.93331121086015\nFO\t-374.9154855653105\nKT\t-473.2105906648109\nNC\t-605.2059339104131\nCJ\t-648.1263228804299\nGJ\t-726.4074734495849\nTN\t-758.6492685824801\nIM\t-877.5180251035473\nNR\t-1040.8373021733964\nVQ\t-1182.3332813844866\nAC\t-1528.9133285032833\nGK\t-1588.8453466994188\nMH\t-1614.0304506650436\nCN\t-1625.7643511985686\nBP\t-1664.6149842540806\nWZ\t-1828.7120588372184\nFP\t-1853.7665843690384\nST\t-1926.9015799800538\nLT\t-1936.8660746835126\nVC\t-1961.9698911549299\nRM\t-2072.859712239212\nRN\t-2117.3568230156748\nMG\t-2177.1359371497197\nBD\t-2189.7276929182053\nTT\t-2198.9888966594312\nWI\t-2411.6052190202367\nMF\t-2583.0096342491906\nWS\t-3033.1919943569414\nNS\t-3419.433783151415\nBX\t-3428.550246177742\nLA\t-3683.288087767324\nFJ\t-3823.7379551806007\nGL\t-4095.6142632411147\nGB\t-4493.4407207735985\nVT\t-4893.56784375223\nYI\t-5161.369727991024\nMB\t-6983.244672031658\nSL\t-7198.0195246861\nBB\t-7714.330447297858\nAN\t-8336.253806826304\nMV\t-8432.76436484512\nBN\t-8436.336910727516\nGY\t-8662.416311814508\nGI\t-8714.828350903834\nGQ\t-8747.741566141962\nDO\t-8837.113008041622\nPU\t-9052.260082585457\nMC\t-10165.58628630213\nRE\t-10288.43518192916\nTI\t-12216.629221576648\nBH\t-12274.660359144182\nTX\t-12668.099871047063\nWA\t-12761.47570936846\nMJ\t-12847.372891726782\nDJ\t-14784.441842846461\nEN\t-14823.252553395536\n"}]},"apps":[],"jobName":"paragraph_1548256451956_463989971","id":"20190123-093049_798854210","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:395"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q3action ORDER BY SumTone ASC LIMIT 100 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ActionCountry":"string","SumTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"ActionCountry\tSumTone\nUS\t-2.0665515155783825E7\n\t-6252399.85185993\nIS\t-5640756.059464867\nRS\t-4107052.423176143\nIR\t-3982411.115814836\nSY\t-3322326.6577215707\nTU\t-3251340.8168037017\nUK\t-2455336.065463683\nFR\t-2078886.3316013636\nAF\t-2047176.252850867\nUP\t-1980943.318148433\nGM\t-1764441.71737575\nPK\t-1657256.5992559423\nIN\t-1458903.4351592402\nSP\t-1303661.1494562959\nVE\t-1281348.9489528171\nCI\t-1182925.1113421968\nBR\t-1113626.8508246744\nRO\t-1047669.1089709776\nMX\t-1017462.5382638662\nWE\t-1001901.0681701994\nAL\t-962322.6608661753\nCA\t-934387.7849683422\nIZ\t-925597.0841671091\nNI\t-784880.2994857983\nBE\t-774579.3442598461\nPE\t-758331.3903410243\nCH\t-742621.387357796\nEG\t-739069.7441815265\nIT\t-695302.9535918672\nSW\t-645153.1113939735\nCO\t-642910.4883813036\nKN\t-616236.9227525145\nAS\t-613579.4068476163\nYM\t-599115.6082059704\nKS\t-587298.7053601596\nTS\t-587142.4504797986\nDA\t-553158.2029671511\nSZ\t-552141.3895774017\nRB\t-530841.1468421705\nPL\t-528318.0462545148\nBG\t-484786.56418044347\nRP\t-463345.57582282636\nLY\t-433642.3525574048\nSA\t-430841.5542799176\nAR\t-410969.6512326494\nGR\t-391981.6942435605\nLE\t-389904.8108289582\nRI\t-378843.62638581306\nSF\t-339137.8021986308\nSU\t-330838.70508632495\nKV\t-328207.63985980046\nBM\t-301684.3918059419\nEC\t-292437.427893576\nID\t-282972.4591687209\nHA\t-281791.5870700468\nVM\t-276859.5673810076\nJA\t-272732.0748179492\nNL\t-243102.76208680117\nMK\t-225505.0381236204\nHO\t-218987.98469717058\nEZ\t-212496.77819881286\nTH\t-212147.50563837955\nGZ\t-207815.2450702336\nBL\t-204957.07628993265\nSG\t-195685.4491353627\nKE\t-188507.11324027998\nML\t-182738.5526267918\nEI\t-182568.19174257884\nET\t-179271.9234339599\nJO\t-179126.24879407624\nQA\t-171837.96196400677\nAU\t-168111.83927995447\nSO\t-166597.95484457616\nHU\t-150365.15949438963\nMO\t-140536.30642101925\nCG\t-135986.47809507075\nCU\t-135735.67751058424\nKZ\t-132785.15125171706\nBO\t-132383.59924680096\nMD\t-130600.99312418082\nPO\t-127749.35474200125\nAG\t-126691.82994546965\nNO\t-120719.26830125197\nZI\t-120283.9467833387\nPM\t-117132.04566405699\nMY\t-108921.81343459805\nBU\t-106659.25016663721\nCM\t-105019.41941200144\nHR\t-104526.32268842311\nGT\t-102910.56076477264\nAJ\t-102070.4678444571\nFI\t-100803.20395544951\nES\t-100679.10457626877\nUG\t-96655.38481839048\nCF\t-95260.62038632232\nGH\t-82477.94592458098\nOD\t-77494.43564492534\nAM\t-72072.97557338692\nUY\t-65086.09236057424\n"}]},"apps":[],"jobName":"paragraph_1548256451956_-957059676","id":"20190123-093106_1051560305","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:396"},{"text":"%md\nPer Month","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Per Month</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451957_-1116697751","id":"20190123-093131_564366340","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:397"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q3month ORDER BY SumTone DESC LIMIT 100 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Month":"string","SumTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Month","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"SumTone","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Month\tSumTone\n200802\t-485.8833084817094\n200801\t-8318.4162193328\n201712\t-347783.41866865155\n201701\t-651407.4402186493\n201801\t-9.534457927939968E7\n"}]},"apps":[],"jobName":"paragraph_1548256451958_-1471069841","id":"20190123-093139_706447116","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:398"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q3month ORDER BY SumTone ASC LIMIT 100 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-24T09:02:54+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Month":"string","SumTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Month","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"SumTone","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Month\tSumTone\n201801\t-9.534457927939968E7\n201701\t-651407.4402186492\n201712\t-347783.4186686515\n200801\t-8318.4162193328\n200802\t-485.8833084817094\n"}]},"apps":[],"jobName":"paragraph_1548256451958_464833708","id":"20190123-093137_240596140","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:399"},{"text":"%md\nPer Actor","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Per Actor</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451959_564527399","id":"20190123-093215_1961583780","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:400"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q3actor ORDER BY SumTone DESC LIMIT 100 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Actor1Code":"string","SumTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Actor1Code","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"SumTone","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Actor1Code\tSumTone\nNGAGOV\t79292.04474922467\nBFA\t27288.691876204175\nARE\t18519.22068294315\nNRMRAC020\t11256.593141708227\nKWT\t11093.657241542509\nMKDLEG\t7578.239948012334\nCHRDOX\t6980.142619718221\nLABMED\t6812.868689161198\nBHRGOV\t6669.649512752995\nJPNGOV\t5280.817234493198\nIGOSEAASN\t5226.998455719365\nEGYBUS\t5205.312139702974\nNMR\t4222.555045184831\nLAO\t4040.281961075128\nNORGOVDEV\t3932.5890694062023\nltn\t3721.3241310714197\nLBRGOV\t3693.459143954627\nCZELEG\t3633.9392329756843\nEGYEDU\t3346.9578626371517\nOMN\t3185.663669196716\nISRBUS\t3003.0807857918844\nEGYOPPPTY\t2964.2203535373146\nTUNLEG\t2931.105475467985\nIGOUNODEV\t2688.406037773616\nCVLEDU\t2602.3682307024797\nAREBUS\t2594.2392612518506\nGAB\t2341.6102643565655\nCYPGOV\t2331.3406345937237\nAREGOV\t2205.2627832618527\nARMGOV\t2142.930537524216\nBRN\t2101.578043349022\nSGPGOV\t2048.9726726789013\nAZEGOV\t1886.5953749578846\nNGOCHR\t1807.0080876571285\nMNC\t1667.066967619179\nLBR\t1645.1593281318724\nFINGOV\t1617.6829392990228\nHINAST700\t1571.4358107398425\nIRQPTY\t1526.6284144687272\nJORMIL\t1469.6096056554684\nQATBUS\t1364.7578933740608\nEGYLEG\t1353.891068110485\nBUSEDU\t1172.9018510819483\nSAUBUS\t1139.6056814302988\nKWTGOV\t1104.603674723089\nSTP\t1103.6551149378165\nMOSSHI300\t1098.9347879555035\nCHRREL\t1071.480156686048\nARECOP\t1013.8477338429582\nMDVELI\t936.5681186748966\nISREDU\t923.5020026541829\nAREEDU\t915.2643051584301\nLAOGOV\t908.2536636637831\nSYREDU\t904.2923677251931\nSAUEDU\t897.9759485123811\nMNCFINMED\t895.1581611348092\nOMNEDU\t876.3486670405272\nBHRBUS\t853.7414436615118\nLTUGOV\t777.9310211462241\nELICHR\t763.6989116278753\nNORGOV\t749.5980614234119\nCHRDOXREL\t732.7271138486109\nEGYLAB\t719.8803845517732\nSYC\t713.4126614247218\nIGOAFRDEVAFB\t686.2896497234402\nBHRLEG\t664.1034156559496\nHRVLEG\t647.0023780975417\nBTN\t639.498885673443\ntel\t624.990273946656\nBUSBUS\t613.2309791817456\nBWAMED\t599.7716753719416\nIMGSEAMOS\t586.6557907060887\nBHREDU\t583.7154442491988\nJPNELI\t573.750684184774\nMNGGOV\t553.2349504352261\nMNCHKG\t552.6206399120335\nTKMGOV\t536.0743663663502\nFJI\t526.3428864330566\nARMREL\t525.657107288197\nQATEDU\t517.9514468347259\nDEUGOVJUD\t515.4195742587239\nMCOELIGOV\t512.1489970216548\nNZLLEG\t511.79700753149734\nJORBUS\t492.30879328010076\nCHRPRO300\t491.1360223845455\nLEGBUS\t488.4902166255476\nmad\t478.44251776336364\nDEUELI\t469.06773369665154\nGRCREL\t468.6164175751443\nOMNBUS\t467.582005369618\nMKDREL\t466.04967776714693\nGABGOV\t456.9778031812856\nIGOUNOREFHCRGOV\t444.31405256994015\nAGOCVL\t436.9827857537046\nSCGSRBBUS\t433.04820764705914\nAREMED\t422.90103095770843\nFJIGOV\t421.16832437448824\nJORREL\t419.9426998086705\nLKABUS\t414.9435893115076\nJOREDU\t409.1522514283869\n"}]},"apps":[],"jobName":"paragraph_1548256451959_724509505","id":"20190123-093208_2126902180","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:401"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q3actor ORDER BY SumTone ASC LIMIT 100 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-24T09:02:55+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Month":"string","SumTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[],"values":[{"name":"SumTone","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Actor1Code\tSumTone\n\t-9112975.971465034\nUSA\t-8924652.529858133\nCOP\t-7893002.940034018\nGOV\t-7136402.023394998\nJUD\t-4492283.446751781\nCVL\t-2589795.4373723622\nISR\t-2055769.8798623595\nRUS\t-1989804.3720479938\nMED\t-1886484.103897684\nTUR\t-1729236.9242478712\nMIL\t-1675190.5566511382\nOPP\t-1641701.605707207\nCRM\t-1626745.216976988\nIRN\t-1602536.9531795576\nSYR\t-1453022.3000621716\nPSE\t-1430635.0707719557\nLEG\t-1417064.4736598632\nUAF\t-1344567.6027540164\nHLH\t-1095242.6806389377\nGBR\t-883400.7056730012\nFRA\t-849049.0891270513\nUSAGOV\t-843350.0625446044\nBUS\t-801697.8873622243\nDEU\t-769053.5921745342\nPAK\t-735883.5214527817\nAFG\t-706107.5967145523\nLAB\t-692473.3132331801\nUKR\t-690290.0553379236\nEDU\t-642716.6784982918\nUSAMED\t-497107.87307677686\nESP\t-496700.1476766922\nREB\t-459645.49068813893\nREF\t-441626.0188602704\nCAN\t-440550.72611611756\nIRQ\t-430026.2463231184\nCHL\t-425706.64166574075\nVEN\t-402755.0390439767\nCHRCTH\t-358745.5823307304\nPRK\t-354581.41145048855\nUSAJUD\t-340015.667426475\nIND\t-328418.8154278967\nCHN\t-320100.5718671284\nMOS\t-319481.52443267236\nPER\t-318916.1337825815\nMEX\t-314506.0105510792\nBEL\t-303942.4605457873\nEGY\t-294480.9182657202\nUSACOP\t-291700.6940679945\nISRGOV\t-282932.921037128\nPTY\t-274170.1877692591\nBRA\t-266522.0885145408\nIGOUNO\t-265392.9648243159\nAFGINSTAL\t-259597.33286056566\nAUS\t-254962.28260375088\nEUR\t-251170.1035747427\nITA\t-247737.65912642804\nPOL\t-244925.80422555472\nIRNGOV\t-241698.56430058964\nAFR\t-240595.26371910883\nREL\t-239331.8614064752\nKOR\t-231493.43369215733\nMDV\t-228658.20752101197\nLBN\t-227692.01859674734\nSAU\t-214101.43309804462\nTURGOV\t-211165.49591614393\nDNK\t-202040.39505951674\nYEM\t-197941.84403600814\nCHE\t-196108.46783902583\nROU\t-192605.0493183763\nALB\t-191814.2145399831\nTUN\t-187540.06764154826\nLBY\t-186068.30389822208\nSWE\t-173951.99273143354\nSCGSRB\t-171704.24312741455\nCOL\t-167825.3341455029\nGRC\t-164883.1899224656\nPHL\t-156561.78613743215\nMMR\t-151257.92757124026\nRUSGOV\t-149278.97574008277\nPSECVL\t-138550.9829408313\nTURMIL\t-137734.9707712287\nBGD\t-136094.12415602006\nJPN\t-132768.84566741838\nVNM\t-131008.57111675474\nIGOEUREEC\t-127909.90439890343\nNGA\t-126977.6767916735\nSYRGOV\t-126910.10841122553\nSPY\t-122370.5205139058\nJOR\t-121420.08661749601\nGOVMIL\t-121082.57574498752\nSDN\t-121049.86087272392\nELI\t-120866.13784805674\nISRMIL\t-120430.3318091265\nUSALEG\t-109104.40891233875\nGBRGOV\t-106781.11767532739\nFRAGOV\t-106349.0814506661\nQAT\t-106199.78210231534\nECU\t-105894.429641601\nHTI\t-105799.9354965423\nARG\t-105114.33073633756\n"}]},"apps":[],"jobName":"paragraph_1548256451960_-879002820","id":"20190123-093207_416259649","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:402"},{"text":"%md\n## Question 4","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Question 4</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451961_-709197278","id":"20190122-220101_1897012493","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:403"},{"text":"%md\nWhat are the actors, countries, organisations that divide the most ?","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>What are the actors, countries, organisations that divide the most ?</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451961_-653598199","id":"20190122-220100_116601955","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:404"},{"text":"// Events\nval events_trans_4 = exportDF_trans.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(5).as(\"actor1code\"),\n    $\"_tmp\".getItem(34).as(\"avgtone\"),\n    $\"_tmp\".getItem(37).as(\"actor1country\")\n    )\nval events_4 = exportDF.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(5).as(\"actor1code\"),\n    $\"_tmp\".getItem(34).as(\"avgtone\"),\n    $\"_tmp\".getItem(37).as(\"actor1country\")\n    )\n\n// Union\nval df_events_4 = events_4.union(events_trans_4)\n\n// Cast\nval df_4_cast =  df_events_4.withColumn(\"avgtone\", df_events_4(\"avgtone\").cast(\"float\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"events_trans_4: org.apache.spark.sql.DataFrame = [Actor1Code: string, AvgTone: string ... 1 more field]\nevents_4: org.apache.spark.sql.DataFrame = [Actor1Code: string, AvgTone: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1548256451962_1569784384","id":"20190122-214009_1372374074","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:405"},{"text":"// Group By : Split for the requests\nval df_4_gby = df_4_cast.groupBy( \"actor1code\", \"actor1country\").agg(stddev($\"avgtone\").as(\"avgtone\"))\nval df_4_gby_2 = df_4_gby.filter(col(\"avgtone\").isNotNull())","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"df_4_gby: org.apache.spark.sql.DataFrame = [actor1code: string, actor1country: string ... 1 more field]\nwarning: there was one deprecation warning; re-run with -deprecation for details\njava.lang.RuntimeException: Unsupported literal type class scala.runtime.BoxedUnit ()\n  at org.apache.spark.sql.catalyst.expressions.Literal$.apply(literals.scala:78)\n  at org.apache.spark.sql.catalyst.expressions.Literal$$anonfun$create$2.apply(literals.scala:164)\n  at org.apache.spark.sql.catalyst.expressions.Literal$$anonfun$create$2.apply(literals.scala:164)\n  at scala.util.Try.getOrElse(Try.scala:79)\n  at org.apache.spark.sql.catalyst.expressions.Literal$.create(literals.scala:163)\n  at org.apache.spark.sql.functions$.typedLit(functions.scala:127)\n  at org.apache.spark.sql.functions$.lit(functions.scala:110)\n  at org.apache.spark.sql.Column.apply(Column.scala:213)\n  ... 64 elided\n"}]},"apps":[],"jobName":"paragraph_1548256451963_1153282230","id":"20190122-214007_398400394","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:406"},{"text":"%md\nIn Cassandra","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In Cassandra</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451963_1939201124","id":"20190123-112801_907298976","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:407"},{"text":"%cassandra\nCREATE TABLE q4(\nactor1country text,\nactor1code text,\navgtone double,\nPRIMARY KEY (actor1country, actor1code));","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451964_839134193","id":"20190123-112804_1136248780","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:408"},{"text":"df_4_gby_2.write.cassandraFormat(\"q4\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451964_212903922","id":"20190123-112807_560343136","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:409"},{"text":"%md\nRead it","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Read it</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451965_-465773430","id":"20190123-112800_1222354210","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:410"},{"text":"val df_4 = spark.read.cassandraFormat(\"q4\", \"gdelt_datas\").load()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451965_31389708","id":"20190123-113017_1742276180","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:411"},{"text":"df_4.createOrReplaceTempView(\"q4\")","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548256451966_-77739746","id":"20190122-220417_352195198","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:412"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q4 ORDER BY AvgTone DESC LIMIT 50 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Actor1Code":"string","Actor1Country":"string","AvgTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Actor1Code\tActor1Country\tAvgTone\nAUSMIL\tBX\tNaN\nMNCUSA\tMJ\tNaN\nNORELI\tFJ\tNaN\nMNCFRAMED\tSF\tNaN\nGOVOPP\tBE\tNaN\nINDCRM\tPK\tNaN\nITAMIL\tKE\tNaN\nFRALAB\tSN\tNaN\nIDNGOVMIL\tCH\tNaN\nDEUGOVAGR\tIN\tNaN\nIGOBUSOPCDEV\tLE\tNaN\nPHLBUS\tNI\tNaN\nKENGOVENV\tUS\tNaN\nKAZ\tGR\tNaN\nmdi\tEN\tNaN\nIGOUNOWBKGOV\tIT\tNaN\nITA\tCJ\tNaN\nFJIGOV\tKS\tNaN\nKHM\tMZ\tNaN\nSSDGOV\tSZ\tNaN\nUSAEDU\tFM\tNaN\nCHRDOX115\tMX\tNaN\nKWT\tNZ\tNaN\nMYS\tOD\tNaN\nMILJUD\tGZ\tNaN\nNGAMIL\tCG\tNaN\nSYRJEW\tIS\tNaN\nESPGOV\tJA\tNaN\nTCDGOV\tGM\tNaN\nAFGINSTAL\tRQ\tNaN\nRUSGOV\tBB\tNaN\nCOG\tGH\tNaN\nPANELI\tJA\tNaN\nBUSCVL\tIC\tNaN\nLTULEG\tLG\tNaN\nnep\tRW\tNaN\nMCO\tGR\tNaN\nTUNGOV\tSF\tNaN\nMOSSHI\tVM\tNaN\nZROREF\tUS\tNaN\nEDUGOV\tMD\tNaN\nMLI\tES\tNaN\nVENELI\tTD\tNaN\nSLBMIL\tBP\tNaN\nkno\tCF\tNaN\nISRGOV\tTO\tNaN\nATGCHR\tAC\tNaN\nNGOICGGOV\tUS\tNaN\nSGPGOVHLH\tJA\tNaN\nHRI\tMA\tNaN\n"}]},"apps":[],"jobName":"paragraph_1548256451966_478242172","id":"20190122-220901_764134390","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:413"},{"text":"%md\n## Question 5","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Question 5</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451967_-1705843303","id":"20190122-220918_1444419138","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:414"},{"text":"%md\nUnderstand evolution of relations between countries over time","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Understand evolution of relations between countries over time</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451968_-255836020","id":"20190122-220916_1736956892","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:415"},{"text":"%md\n1. Plot a time series for a given Pair of countries","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<ol>\n  <li>Plot a time series for a given Pair of countries</li>\n</ol>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451968_712906086","id":"20190123-133023_1666970684","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:416"},{"text":"// Events\nval events_trans_5 = exportDF_trans.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(1).as(\"day\"),\n    $\"_tmp\".getItem(34).as(\"avgtone\"),\n    $\"_tmp\".getItem(37).as(\"actor1country\"),\n    $\"_tmp\".getItem(45).as(\"actor2country\")\n    )\nval events_5 = exportDF.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(1).as(\"day\"),\n    $\"_tmp\".getItem(34).as(\"avgtone\"),\n    $\"_tmp\".getItem(37).as(\"actor1country\"),\n    $\"_tmp\".getItem(45).as(\"actor2country\")\n    )\n\n// Union\nval df_events_5 = events_5.union(events_trans_5)\n\n// Cast type\nval df_5_cast =  df_events_5.withColumn(\"avgtone\", df_events_5(\"avgtone\").cast(\"float\")).withColumn(\"day\", df_events_5(\"day\").cast(IntegerType))\n\n// Group By\nval df_5_gby = df_5_cast.groupBy( \"day\", \"actor1country\", \"actor2country\").agg(avg($\"avgtone\").as(\"avgtone\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"events_trans_5: org.apache.spark.sql.DataFrame = [month: string, avgtone: string ... 2 more fields]\nevents_5: org.apache.spark.sql.DataFrame = [month: string, avgtone: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1548256451969_961473092","id":"20190122-220914_1298624591","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:417"},{"text":"%md\nin Cassandra","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>in Cassandra</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451969_993049389","id":"20190123-124746_1632654869","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:418"},{"text":"%cassandra\nCREATE TABLE q5(\nday int,\nactor1country text,\nactor2country text,\navgtone double,\nPRIMARY KEY (month, actor1country, actor2country));","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451970_1077897596","id":"20190123-124749_68574520","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:419"},{"text":"df_5_gby.write.cassandraFormat(\"q5\", \"gdelt_datas\").save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451970_129368819","id":"20190123-124752_2078904257","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:420"},{"text":"%md\nRead it","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Read it</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451971_-445995274","id":"20190123-125010_232961893","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:421"},{"text":"val df_5 = spark.read.cassandraFormat(\"q5\", \"gdelt_datas\").load()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451971_2006184653","id":"20190123-125007_622839327","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:422"},{"text":"df_5.createOrReplaceTempView(\"q5\")","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548256451972_738789833","id":"20190122-221346_394791419","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:423"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q5 LIMIT 10 \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Month":"string","Actor1Country":"string","Actor2Country":"string","AvgTone":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Month\tActor1Country\tActor2Country\tAvgTone\n201801\tUS\tIS\t-2.8923964893380387\n201801\t\tDJ\t-0.584059680769151\n201801\t\tFR\t-2.057616280920609\n201801\tIR\tVE\t-3.3365639027253664\n201801\tIS\tUK\t-3.046715274126899\n201801\tIV\t\t-0.21406495377789134\n201801\t\tEC\t-2.1288471543957557\n201801\tUK\tRS\t-3.019204278009286\n201801\tAR\tUS\t-1.0436253045003818\n201801\tVM\tAF\t-1.20689655172414\n"}]},"apps":[],"jobName":"paragraph_1548256451972_-1782231184","id":"20190122-221218_1027175873","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:424"},{"text":"z.show(spark.sql(\"\"\" SELECT day, avgtone FROM q5 WHERE actor1country=\"US\" AND actor2country=\"IS\" \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.sql.AnalysisException: Table or view not found: q5; line 1 pos 28\n  at org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:47)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupTableFromCatalog(Analyzer.scala:733)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.resolveRelation(Analyzer.scala:685)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$8.applyOrElse(Analyzer.scala:715)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$8.applyOrElse(Analyzer.scala:708)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$apply$1.apply(AnalysisHelper.scala:90)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$apply$1.apply(AnalysisHelper.scala:90)\n  at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:89)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)\n  at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:326)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:324)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:87)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)\n  at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1$$anonfun$1.apply(AnalysisHelper.scala:87)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:326)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:187)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:324)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:87)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$$anonfun$resolveOperatorsUp$1.apply(AnalysisHelper.scala:86)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$class.resolveOperatorsUp(AnalysisHelper.scala:86)\n  at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:708)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:654)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:87)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1$$anonfun$apply$1.apply(RuleExecutor.scala:84)\n  at scala.collection.LinearSeqOptimized$class.foldLeft(LinearSeqOptimized.scala:124)\n  at scala.collection.immutable.List.foldLeft(List.scala:84)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:84)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor$$anonfun$execute$1.apply(RuleExecutor.scala:76)\n  at scala.collection.immutable.List.foreach(List.scala:392)\n  at org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:76)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:127)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:121)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$executeAndCheck$1.apply(Analyzer.scala:106)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$$anonfun$executeAndCheck$1.apply(Analyzer.scala:105)\n  at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:201)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:105)\n  at org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:57)\n  at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:55)\n  at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:47)\n  at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:79)\n  at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:642)\n  ... 64 elided\nCaused by: org.apache.spark.sql.catalyst.analysis.NoSuchTableException: Table or view 'q5' not found in database 'default';\n  at org.apache.spark.sql.hive.client.HiveClient$$anonfun$getTable$1.apply(HiveClient.scala:81)\n  at org.apache.spark.sql.hive.client.HiveClient$$anonfun$getTable$1.apply(HiveClient.scala:81)\n  at scala.Option.getOrElse(Option.scala:121)\n  at org.apache.spark.sql.hive.client.HiveClient$class.getTable(HiveClient.scala:81)\n  at org.apache.spark.sql.hive.client.HiveClientImpl.getTable(HiveClientImpl.scala:83)\n  at org.apache.spark.sql.hive.HiveExternalCatalog.getRawTable(HiveExternalCatalog.scala:118)\n  at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$getTable$1.apply(HiveExternalCatalog.scala:700)\n  at org.apache.spark.sql.hive.HiveExternalCatalog$$anonfun$getTable$1.apply(HiveExternalCatalog.scala:700)\n  at org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:97)\n  at org.apache.spark.sql.hive.HiveExternalCatalog.getTable(HiveExternalCatalog.scala:699)\n  at org.apache.spark.sql.catalyst.catalog.ExternalCatalogWithListener.getTable(ExternalCatalogWithListener.scala:138)\n  at org.apache.spark.sql.catalyst.catalog.SessionCatalog.lookupRelation(SessionCatalog.scala:701)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupTableFromCatalog(Analyzer.scala:730)\n  ... 116 more\n"}]},"apps":[],"jobName":"paragraph_1548256451973_-1890194955","id":"20190122-221216_768114033","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:425"},{"text":"%md\n2. Use GKG Table to understand where events take place and what kind of events","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<ol>\n  <li>Use GKG Table to understand where events take place and what kind of events</li>\n</ol>\n</div>"}]},"apps":[],"jobName":"paragraph_1548256451974_596729097","id":"20190123-133042_151094091","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:426"},{"text":"val gkgRDD = sc.binaryFiles(\"s3a://fabien-mael-telecom-gdelt2018/201801*.gkg.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile{ case null => zis.close(); false\n                       case _ => true }.\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\nval gkgDF = gkgRDD.map(x => x.split(\"\\t\")).map(row => row.mkString(\";\")).map(x => x.split(\";\")).toDF()\n\n\nval gkgRDD_trans = sc.binaryFiles(\"s3a://fabien-mael-telecom-gdelt2018/201801*translation.gkg.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile{ case null => zis.close(); false\n                       case _ => true }.\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\nval gkgDF_trans = gkgRDD_trans.map(x => x.split(\"\\t\")).map(row => row.mkString(\";\")).map(x => x.split(\";\")).toDF()\n","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451974_-378277996","id":"20190123-133454_446705504","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:427"},{"text":"val gkg_trans = gkgDF_trans.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(1).as(\"date\"),\n    $\"_tmp\".getItem(5).as(\"counts\"),\n    )\nval gkg = gkgDF.withColumn(\"_tmp\", $\"value\").select(\n    $\"_tmp\".getItem(1).as(\"date\"),\n    $\"_tmp\".getItem(5).as(\"counts\"),\n    )\n\nval df_gkg = gkg.union(gkg_trans)","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451975_-878542623","id":"20190123-142537_1272101429","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:428"},{"text":"val df_gkg_final =  df_gk..withColumn(\"date_format\", expr(\"substring(date, 1, length(value)-6)\"))).withColumn(\"category\", substring_index(col(\"counts\"), \"#\", 0)).withColumn(\"count\", substring_index(col(\"counts\"), \"#\", 1)).withColumn(\"subject\", substring_index(col(\"counts\"), \"#\", 2)).withColumn(\"country\", substring_index(col(\"counts\"), \"#\", 5)).withColumn(\"latitude\", substring_index(col(\"counts\"), \"#\", 7)).withColumn(\"longitude\", substring_index(col(\"counts\"), \"#\", 8))\n    ).drop(\"counts\").drop(\"date\")\n\nval df_gkg_cast = df_gkg_final.withColumn(\"date_format\", df_gkg_final(\"date_format\").cast(IntegerType)).withColumn(\"count\", df_gkg_final(\"count\").cast(IntegerType)).withColumn(\"latitude\", df_gkg_final(\"latitude\").cast(\"float\")).withColumn(\"longitude\", df_gkg_final(\"longitude\").cast(\"float\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451975_-14043613","id":"20190123-133752_1391990767","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:429"},{"text":"%cassandra\nCREATE TABLE q_gkg(\ndate_format int,\ncategory text,\ncount int,\nsubject text,\ncountry text,\nlatitude double,\nlongitude double,\nPRIMARY KEY (category, subject, country));","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451976_1752960275","id":"20190123-142638_1148420611","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:430"},{"text":"df_gkg_cast.write\n  .cassandraFormat(\"q_gkg\", \"gdelt_datas\")\n  .save()","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451976_-1454507632","id":"20190123-142648_1201356046","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:431"},{"text":"val df_gkg_1 = spark\n  .read\n  .cassandraFormat(\"q_gkg\", \"gdelt_datas\")\n  .load()\n  \ndf_gkg_1.createOrReplaceTempView(\"q_gkg\")","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451977_-323742235","id":"20190123-142654_334488611","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:432"},{"text":"z.show(spark.sql(\"\"\" SELECT * FROM q_gkg WHERE category = \"KILL\" AND country = \"US\" \"\"\"))","user":"anonymous","dateUpdated":"2019-01-23T15:14:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548256451977_1716940294","id":"20190123-142710_336878466","dateCreated":"2019-01-23T15:14:11+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:433"}],"name":"AWS","id":"2E3RHSHES","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[],"cassandra:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}